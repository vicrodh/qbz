import{u as v,j as e}from"./main-D9xFhA9f.js";import{u as w,r as i}from"./vendor-i18n-cI2jDZAk.js";import{f,a as N}from"./format-D19H1wt9.js";import"./vendor-react-Dh3zDKDA.js";function n({text:s}){const[a,r]=i.useState(!1),d=i.useCallback(()=>{navigator.clipboard.writeText(s).then(()=>{r(!0),setTimeout(()=>r(!1),2e3)})},[s]);return e.jsx("button",{className:"copy-btn",onClick:d,title:"Copy command",children:a?e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}):e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})}const y="https://api.github.com/repos/vicrodh/qbz/releases",m={aur:"AUR (Arch)",snap:"Snap Store",appimage:"AppImage",flatpak:"Flatpak",deb:"Debian/Ubuntu",rpm:"Fedora/RHEL",tarball:"Tarball",unknown:"Download"},j={aur:0,snap:1,appimage:2,flatpak:3,deb:4,rpm:5,tarball:6,unknown:7},k="https://aur.archlinux.org/packages/qbz-bin",S="https://snapcraft.io/qbz-player",z=s=>{const a=s.toLowerCase();return a.endsWith(".appimage")?"appimage":a.endsWith(".flatpak")?"flatpak":a.endsWith(".deb")?"deb":a.endsWith(".rpm")?"rpm":a.endsWith(".tar.gz")||a.endsWith(".tgz")||a.endsWith(".tar.xz")?"tarball":"unknown"},C=s=>{const a=s.toLowerCase();return a.includes("aarch64")||a.includes("arm64")?"arm64":a.includes("x86_64")||a.includes("amd64")?"x86_64":null},T=[],p=(s,a)=>{switch(s){case"aur":return"git clone https://aur.archlinux.org/qbz-bin.git && cd qbz-bin && makepkg -si";case"snap":return"sudo snap install qbz-player";case"appimage":return`chmod +x ${a} && ./${a}`;case"deb":return`sudo dpkg -i ${a}`;case"rpm":return`sudo rpm -i ${a}`;case"flatpak":return`flatpak install --user ./${a}`;case"tarball":return`tar -xzf ${a} && ./qbz`;default:return}},b=s=>{if(s==="aur")return{label:"Or using a Helper?",cmds:["yay -Syu qbz-bin","paru -Syu qbz-bin"]}},A=s=>{switch(s){case"deb":return"sudo apt install -y libwebkit2gtk-4.1-0 libgtk-3-0 libayatana-appindicator3-1 gstreamer1.0-plugins-base gstreamer1.0-plugins-good";case"rpm":return"sudo dnf install -y webkit2gtk4.1 gtk3 libappindicator-gtk3 gstreamer1-plugins-base gstreamer1-plugins-good";default:return}},L=s=>s.filter(a=>a.browser_download_url).map(a=>{const r=z(a.name);return{type:r,label:m[r],fileName:a.name,url:a.browser_download_url,size:a.size,arch:C(a.name),installCmd:p(r,a.name),depsCmd:A(r),helperCmds:b(r),helperNote:r==="flatpak"?{label:"Audiophile Setup (Bit-Perfect Audio)",note:'After install, open QBZ → Settings → Audio and select "ALSA Direct" as Audio Backend. Note: PipeWire bit-perfect is unavailable in Flatpak due to sandbox restrictions.'}:void 0}}).filter(a=>!T.includes(a.type)).sort((a,r)=>j[a.type]-j[r.type]),q=()=>{const s=navigator.userAgent.toLowerCase(),a=navigator.platform.toLowerCase(),r=s.includes("linux")&&!s.includes("android"),d=a.includes("mac")||s.includes("mac"),o=a.includes("win")||s.includes("windows"),c=s.includes("aarch64")||s.includes("arm64")?"arm64":"x86_64";return{isLinux:r,isMac:d,isWindows:o,arch:c}},$={type:"aur",label:m.aur,fileName:"qbz-bin",url:k,size:0,arch:null,installCmd:p("aur","qbz-bin"),helperCmds:b("aur")},E={type:"snap",label:m.snap,fileName:"qbz-player",url:S,size:0,arch:null,installCmd:p("snap","qbz-player"),helperNote:{label:"Or install from Snap Store GUI",note:'Search for "QBZ" in your Snap Store application, or click the link below to open the store page.'}},I=s=>q().isLinux?[$,E,...s]:s;function P(){const{t:s}=w(),{language:a}=v(),[r,d]=i.useState(null),[o,c]=i.useState(!1);i.useEffect(()=>{let l=!0;return fetch(y).then(t=>t.ok?t.json():Promise.reject(new Error("release fetch failed"))).then(t=>{if(!l)return;const u=t.find(x=>x.assets&&x.assets.length>0);u?d(u):c(!0)}).catch(()=>{l&&c(!0)}),()=>{l=!1}},[]);const h=i.useMemo(()=>r?L(r.assets):[],[r]),g=i.useMemo(()=>I(h),[h]),_=r?f(r.published_at,a):null;return e.jsx("section",{id:"downloads",className:"section",children:e.jsxs("div",{className:"container",children:[e.jsx("h2",{className:"section__title",children:s("downloads.title")}),e.jsx("p",{className:"section__subtitle",children:s("downloads.lead")}),o&&e.jsxs("div",{className:"card download-state",children:[e.jsx("p",{children:s("downloads.error")}),e.jsx("a",{className:"btn btn-ghost",href:"https://github.com/vicrodh/qbz/releases",target:"_blank",rel:"noreferrer",children:s("downloads.viewAll")})]}),!o&&!r&&e.jsx("div",{className:"card download-state",children:e.jsx("p",{children:s("downloads.loading")})}),r&&e.jsxs("div",{className:"download-grid",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"download-row download-row--stack",children:e.jsxs("div",{className:"download-meta",children:[e.jsx("div",{className:"download-meta__name",children:s("downloads.allLabel")}),e.jsxs("div",{className:"download-meta__file",children:[s("downloads.versionLabel")," ",r.tag_name," · ",_]})]})}),e.jsx("div",{className:"download-list",children:g.map(l=>e.jsxs("div",{className:"download-item",children:[e.jsxs("div",{className:"download-item__header",children:[e.jsxs("div",{className:"download-item__info",children:[e.jsx("span",{className:"download-item__label",children:l.label}),l.arch&&e.jsx("span",{className:"download-item__arch",children:l.arch})]}),e.jsx("span",{className:"download-item__file",children:l.type==="aur"?"Arch User Repository":l.type==="snap"?"Snap Store":`${l.fileName} · ${N(l.size)}`})]}),l.installCmd&&e.jsxs("div",{className:"terminal",children:[e.jsxs("code",{children:[e.jsx("span",{className:"terminal__prompt",children:"$"}),e.jsx("span",{className:"terminal__cmd",children:l.installCmd})]}),e.jsx(n,{text:l.installCmd})]}),l.depsCmd&&e.jsxs("details",{className:"deps-details",children:[e.jsx("summary",{className:"deps-summary",children:"Missing dependencies?"}),e.jsxs("div",{className:"terminal terminal--deps",children:[e.jsxs("code",{children:[e.jsx("span",{className:"terminal__prompt",children:"#"}),e.jsx("span",{className:"terminal__cmd",children:l.depsCmd})]}),e.jsx(n,{text:l.depsCmd})]})]}),l.helperCmds&&e.jsxs("details",{className:"deps-details",children:[e.jsx("summary",{className:"deps-summary",children:l.helperCmds.label}),l.helperCmds.cmds.map(t=>e.jsxs("div",{className:"terminal terminal--deps",children:[e.jsxs("code",{children:[e.jsx("span",{className:"terminal__prompt",children:"$"}),e.jsx("span",{className:"terminal__cmd",children:t})]}),e.jsx(n,{text:t})]},t))]}),l.helperNote&&e.jsxs("details",{className:"deps-details",children:[e.jsx("summary",{className:"deps-summary",children:l.helperNote.label}),e.jsx("p",{style:{fontSize:13,color:"var(--text-secondary)",marginTop:8,lineHeight:1.5},children:l.helperNote.note})]}),e.jsx("a",{className:"btn btn-ghost btn-sm",href:l.url,target:l.type==="aur"||l.type==="snap"?"_blank":void 0,rel:l.type==="aur"||l.type==="snap"?"noreferrer":void 0,children:l.type==="aur"?"View on AUR":l.type==="snap"?"View on Snap Store":"Download"})]},l.fileName))}),e.jsx("a",{className:"btn btn-ghost",href:r.html_url,target:"_blank",rel:"noreferrer",children:s("downloads.viewAll")})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"download-meta",children:[e.jsx("div",{className:"download-meta__name",children:s("downloads.buildTitle")}),e.jsx("div",{className:"download-meta__file",children:s("downloads.buildBody")})]}),e.jsxs("details",{className:"details",style:{marginTop:16},children:[e.jsx("summary",{children:s("downloads.buildInstructions.summary")}),e.jsxs("div",{style:{marginTop:16},children:[e.jsx("div",{className:"download-meta__name",style:{fontSize:14,marginBottom:8},children:s("downloads.buildInstructions.prereqTitle")}),e.jsxs("details",{className:"deps-details",children:[e.jsx("summary",{className:"deps-summary",children:"Arch Linux"}),e.jsxs("div",{className:"terminal terminal--deps",children:[e.jsxs("code",{children:[e.jsx("span",{className:"terminal__prompt",children:"$"}),e.jsx("span",{className:"terminal__cmd",children:"sudo pacman -S base-devel rust nodejs npm webkit2gtk-4.1 gtk3"})]}),e.jsx(n,{text:"sudo pacman -S base-devel rust nodejs npm webkit2gtk-4.1 gtk3"})]})]}),e.jsxs("details",{className:"deps-details",children:[e.jsx("summary",{className:"deps-summary",children:"Debian / Ubuntu"}),e.jsxs("div",{className:"terminal terminal--deps",children:[e.jsxs("code",{children:[e.jsx("span",{className:"terminal__prompt",children:"$"}),e.jsx("span",{className:"terminal__cmd",children:"sudo apt install build-essential curl libwebkit2gtk-4.1-dev libgtk-3-dev libayatana-appindicator3-dev librsvg2-dev"})]}),e.jsx(n,{text:"sudo apt install build-essential curl libwebkit2gtk-4.1-dev libgtk-3-dev libayatana-appindicator3-dev librsvg2-dev"})]})]}),e.jsxs("details",{className:"deps-details",children:[e.jsx("summary",{className:"deps-summary",children:"Fedora"}),e.jsxs("div",{className:"terminal terminal--deps",children:[e.jsxs("code",{children:[e.jsx("span",{className:"terminal__prompt",children:"$"}),e.jsx("span",{className:"terminal__cmd",children:"sudo dnf install webkit2gtk4.1-devel gtk3-devel libappindicator-gtk3-devel librsvg2-devel"})]}),e.jsx(n,{text:"sudo dnf install webkit2gtk4.1-devel gtk3-devel libappindicator-gtk3-devel librsvg2-devel"})]})]}),e.jsxs("details",{className:"deps-details",children:[e.jsx("summary",{className:"deps-summary",children:"Rust + Node.js"}),e.jsxs("div",{className:"terminal terminal--deps",children:[e.jsxs("code",{children:[e.jsx("span",{className:"terminal__prompt",children:"$"}),e.jsx("span",{className:"terminal__cmd",children:"curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh"})]}),e.jsx(n,{text:"curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh"})]}),e.jsx("p",{style:{fontSize:13,color:"var(--text-tertiary)",marginTop:8},children:s("downloads.buildInstructions.nodeNote")})]}),e.jsx("div",{className:"download-meta__name",style:{fontSize:14,marginBottom:8,marginTop:16},children:s("downloads.buildInstructions.cloneTitle")}),e.jsxs("div",{className:"terminal",children:[e.jsxs("code",{children:[e.jsx("span",{className:"terminal__prompt",children:"$"}),e.jsx("span",{className:"terminal__cmd",children:"git clone https://github.com/vicrodh/qbz.git && cd qbz"})]}),e.jsx(n,{text:"git clone https://github.com/vicrodh/qbz.git && cd qbz"})]}),e.jsxs("div",{className:"terminal",style:{marginTop:8},children:[e.jsxs("code",{children:[e.jsx("span",{className:"terminal__prompt",children:"$"}),e.jsx("span",{className:"terminal__cmd",children:"npm install"})]}),e.jsx(n,{text:"npm install"})]}),e.jsxs("div",{className:"terminal",style:{marginTop:8},children:[e.jsxs("code",{children:[e.jsx("span",{className:"terminal__prompt",children:"$"}),e.jsx("span",{className:"terminal__cmd",children:"npm run tauri dev"})]}),e.jsx(n,{text:"npm run tauri dev"})]}),e.jsxs("div",{className:"terminal",style:{marginTop:8},children:[e.jsxs("code",{children:[e.jsx("span",{className:"terminal__prompt",children:"$"}),e.jsx("span",{className:"terminal__cmd",children:"npm run tauri build"})]}),e.jsx(n,{text:"npm run tauri build"})]}),e.jsx("div",{className:"download-meta__name",style:{fontSize:14,marginBottom:8,marginTop:16},children:s("downloads.buildInstructions.apiTitle")}),e.jsx("p",{style:{fontSize:13,color:"var(--text-secondary)",marginBottom:12},children:s("downloads.buildInstructions.apiLead")}),e.jsxs("div",{className:"terminal",children:[e.jsxs("code",{children:[e.jsx("span",{className:"terminal__prompt",children:"$"}),e.jsx("span",{className:"terminal__cmd",children:"cp .env.example .env"})]}),e.jsx(n,{text:"cp .env.example .env"})]}),e.jsx("p",{style:{fontSize:13,color:"var(--text-secondary)",marginTop:12},children:s("downloads.buildInstructions.apiBody")}),e.jsxs("details",{className:"deps-details",style:{marginTop:12},children:[e.jsx("summary",{className:"deps-summary",children:s("downloads.buildInstructions.apiKeysTitle")}),e.jsxs("ul",{className:"list list--compact",style:{marginTop:8},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Last.fm"})," — ",e.jsx("a",{href:"https://www.last.fm/api/account/create",target:"_blank",rel:"noreferrer",children:"last.fm/api/account/create"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Discogs"})," — ",e.jsx("a",{href:"https://www.discogs.com/settings/developers",target:"_blank",rel:"noreferrer",children:"discogs.com/settings/developers"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Spotify"})," — ",e.jsx("a",{href:"https://developer.spotify.com/dashboard",target:"_blank",rel:"noreferrer",children:"developer.spotify.com/dashboard"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Tidal"})," — ",e.jsx("a",{href:"https://developer.tidal.com/",target:"_blank",rel:"noreferrer",children:"developer.tidal.com"})]})]}),e.jsx("p",{style:{fontSize:13,color:"var(--text-tertiary)",marginTop:8},children:s("downloads.buildInstructions.apiOptional")})]})]})]}),e.jsx("p",{style:{fontSize:13,color:"var(--text-tertiary)",marginTop:16},children:s("downloads.buildDisclaimer")})]})]})]})})}export{P as DownloadSection};
